using System;
using System.Globalization;
using System.Collections.Generic;

namespace Din91379
{
    public class Glyphs
    {
        public static readonly string[] LongLatinLetterStarts = {
            "K͟",
            "k͟",
        };

        public static readonly string[] LatinLetters = {
            "A",
            "B",
            "C",
            "D",
            "E",
            "F",
            "G",
            "H",
            "I",
            "J",
            "K",
            "L",
            "M",
            "N",
            "O",
            "P",
            "Q",
            "R",
            "S",
            "T",
            "U",
            "V",
            "W",
            "X",
            "Y",
            "Z",
            "a",
            "b",
            "c",
            "d",
            "e",
            "f",
            "g",
            "h",
            "i",
            "j",
            "k",
            "l",
            "m",
            "n",
            "o",
            "p",
            "q",
            "r",
            "s",
            "t",
            "u",
            "v",
            "w",
            "x",
            "y",
            "z",
            "À",
            "Á",
            "Â",
            "Ã",
            "Ä",
            "Å",
            "Æ",
            "Ç",
            "È",
            "É",
            "Ê",
            "Ë",
            "Ì",
            "Í",
            "Î",
            "Ï",
            "Ð",
            "Ñ",
            "Ò",
            "Ó",
            "Ô",
            "Õ",
            "Ö",
            "Ø",
            "Ù",
            "Ú",
            "Û",
            "Ü",
            "Ý",
            "Þ",
            "ß",
            "à",
            "á",
            "â",
            "ã",
            "ä",
            "å",
            "æ",
            "ç",
            "è",
            "é",
            "ê",
            "ë",
            "ì",
            "í",
            "î",
            "ï",
            "ð",
            "ñ",
            "ò",
            "ó",
            "ô",
            "õ",
            "ö",
            "ø",
            "ù",
            "ú",
            "û",
            "ü",
            "ý",
            "þ",
            "ÿ",
            "Ā",
            "ā",
            "Ă",
            "ă",
            "Ą",
            "ą",
            "Ć",
            "ć",
            "Ĉ",
            "ĉ",
            "Ċ",
            "ċ",
            "Č",
            "č",
            "Ď",
            "ď",
            "Đ",
            "đ",
            "Ē",
            "ē",
            "Ĕ",
            "ĕ",
            "Ė",
            "ė",
            "Ę",
            "ę",
            "Ě",
            "ě",
            "Ĝ",
            "ĝ",
            "Ğ",
            "ğ",
            "Ġ",
            "ġ",
            "Ģ",
            "ģ",
            "Ĥ",
            "ĥ",
            "Ħ",
            "ħ",
            "Ĩ",
            "ĩ",
            "Ī",
            "ī",
            "Ĭ",
            "ĭ",
            "Į",
            "į",
            "İ",
            "ı",
            "Ĳ",
            "ĳ",
            "Ĵ",
            "ĵ",
            "Ķ",
            "ķ",
            "ĸ",
            "Ĺ",
            "ĺ",
            "Ļ",
            "ļ",
            "Ľ",
            "ľ",
            "Ł",
            "ł",
            "Ń",
            "ń",
            "Ņ",
            "ņ",
            "Ň",
            "ň",
            "Ŋ",
            "ŋ",
            "Ō",
            "ō",
            "Ŏ",
            "ŏ",
            "Ő",
            "ő",
            "Œ",
            "œ",
            "Ŕ",
            "ŕ",
            "Ŗ",
            "ŗ",
            "Ř",
            "ř",
            "Ś",
            "ś",
            "Ŝ",
            "ŝ",
            "Ş",
            "ş",
            "Š",
            "š",
            "Ţ",
            "ţ",
            "Ť",
            "ť",
            "Ŧ",
            "ŧ",
            "Ũ",
            "ũ",
            "Ū",
            "ū",
            "Ŭ",
            "ŭ",
            "Ů",
            "ů",
            "Ű",
            "ű",
            "Ų",
            "ų",
            "Ŵ",
            "ŵ",
            "Ŷ",
            "ŷ",
            "Ÿ",
            "Ź",
            "ź",
            "Ż",
            "ż",
            "Ž",
            "ž",
            "Ƈ",
            "ƈ",
            "Ə",
            "Ɨ",
            "Ơ",
            "ơ",
            "Ư",
            "ư",
            "Ʒ",
            "Ǎ",
            "ǎ",
            "Ǐ",
            "ǐ",
            "Ǒ",
            "ǒ",
            "Ǔ",
            "ǔ",
            "Ǖ",
            "ǖ",
            "Ǘ",
            "ǘ",
            "Ǚ",
            "ǚ",
            "Ǜ",
            "ǜ",
            "Ǟ",
            "ǟ",
            "Ǣ",
            "ǣ",
            "Ǥ",
            "ǥ",
            "Ǧ",
            "ǧ",
            "Ǩ",
            "ǩ",
            "Ǫ",
            "ǫ",
            "Ǭ",
            "ǭ",
            "Ǯ",
            "ǯ",
            "ǰ",
            "Ǵ",
            "ǵ",
            "Ǹ",
            "ǹ",
            "Ǻ",
            "ǻ",
            "Ǽ",
            "ǽ",
            "Ǿ",
            "ǿ",
            "Ȓ",
            "ȓ",
            "Ș",
            "ș",
            "Ț",
            "ț",
            "Ȟ",
            "ȟ",
            "ȧ",
            "Ȩ",
            "ȩ",
            "Ȫ",
            "ȫ",
            "Ȭ",
            "ȭ",
            "Ȯ",
            "ȯ",
            "Ȱ",
            "ȱ",
            "Ȳ",
            "ȳ",
            "ə",
            "ɨ",
            "ʒ",
            "Ḃ",
            "ḃ",
            "Ḇ",
            "ḇ",
            "Ḋ",
            "ḋ",
            "Ḍ",
            "ḍ",
            "Ḏ",
            "ḏ",
            "Ḑ",
            "ḑ",
            "Ḝ",
            "ḝ",
            "Ḟ",
            "ḟ",
            "Ḡ",
            "ḡ",
            "Ḣ",
            "ḣ",
            "Ḥ",
            "ḥ",
            "Ḧ",
            "ḧ",
            "Ḩ",
            "ḩ",
            "Ḫ",
            "ḫ",
            "ḯ",
            "Ḱ",
            "ḱ",
            "Ḳ",
            "ḳ",
            "Ḵ",
            "ḵ",
            "Ḷ",
            "ḷ",
            "Ḻ",
            "ḻ",
            "Ṁ",
            "ṁ",
            "Ṃ",
            "ṃ",
            "Ṅ",
            "ṅ",
            "Ṇ",
            "ṇ",
            "Ṉ",
            "ṉ",
            "Ṓ",
            "ṓ",
            "Ṕ",
            "ṕ",
            "Ṗ",
            "ṗ",
            "Ṙ",
            "ṙ",
            "Ṛ",
            "ṛ",
            "Ṟ",
            "ṟ",
            "Ṡ",
            "ṡ",
            "Ṣ",
            "ṣ",
            "Ṫ",
            "ṫ",
            "Ṭ",
            "ṭ",
            "Ṯ",
            "ṯ",
            "Ẁ",
            "ẁ",
            "Ẃ",
            "ẃ",
            "Ẅ",
            "ẅ",
            "Ẇ",
            "ẇ",
            "Ẍ",
            "ẍ",
            "Ẏ",
            "ẏ",
            "Ẑ",
            "ẑ",
            "Ẓ",
            "ẓ",
            "Ẕ",
            "ẕ",
            "ẖ",
            "ẗ",
            "ẞ",
            "Ạ",
            "ạ",
            "Ả",
            "ả",
            "Ấ",
            "ấ",
            "Ầ",
            "ầ",
            "Ẩ",
            "ẩ",
            "Ẫ",
            "ẫ",
            "Ậ",
            "ậ",
            "Ắ",
            "ắ",
            "Ằ",
            "ằ",
            "Ẳ",
            "ẳ",
            "Ẵ",
            "ẵ",
            "Ặ",
            "ặ",
            "Ẹ",
            "ẹ",
            "Ẻ",
            "ẻ",
            "Ẽ",
            "ẽ",
            "Ế",
            "ế",
            "Ề",
            "ề",
            "Ể",
            "ể",
            "Ễ",
            "ễ",
            "Ệ",
            "ệ",
            "Ỉ",
            "ỉ",
            "Ị",
            "ị",
            "Ọ",
            "ọ",
            "Ỏ",
            "ỏ",
            "Ố",
            "ố",
            "Ồ",
            "ồ",
            "Ổ",
            "ổ",
            "Ỗ",
            "ỗ",
            "Ộ",
            "ộ",
            "Ớ",
            "ớ",
            "Ờ",
            "ờ",
            "Ở",
            "ở",
            "Ỡ",
            "ỡ",
            "Ợ",
            "ợ",
            "Ụ",
            "ụ",
            "Ủ",
            "ủ",
            "Ứ",
            "ứ",
            "Ừ",
            "ừ",
            "Ử",
            "ử",
            "Ữ",
            "ữ",
            "Ự",
            "ự",
            "Ỳ",
            "ỳ",
            "Ỵ",
            "ỵ",
            "Ỷ",
            "ỷ",
            "Ỹ",
            "ỹ",
            "A̋",
            "C̀",
            "C̄",
            "C̆",
            "C̈",
            "C̕",
            "C̣",
            "C̦",
            "C̨̆",
            "D̂",
            "F̀",
            "F̄",
            "G̀",
            "H̄",
            "H̦",
            "H̱",
            "J́",
            "J̌",
            "K̀",
            "K̂",
            "K̄",
            "K̇",
            "K̕",
            "K̛",
            "K̦",
            "K͟H",
            "K͟h",
            "L̂",
            "L̥",
            "L̥̄",
            "L̦",
            "M̀",
            "M̂",
            "M̆",
            "M̐",
            "N̂",
            "N̄",
            "N̆",
            "N̦",
            "P̀",
            "P̄",
            "P̕",
            "P̣",
            "R̆",
            "R̥",
            "R̥̄",
            "S̀",
            "S̄",
            "S̛̄",
            "S̱",
            "T̀",
            "T̄",
            "T̈",
            "T̕",
            "T̛",
            "U̇",
            "Z̀",
            "Z̄",
            "Z̆",
            "Z̈",
            "Z̧",
            "a̋",
            "c̀",
            "c̄",
            "c̆",
            "c̈",
            "c̕",
            "c̣",
            "c̦",
            "c̨̆",
            "d̂",
            "f̀",
            "f̄",
            "g̀",
            "h̄",
            "h̦",
            "j́",
            "k̀",
            "k̂",
            "k̄",
            "k̇",
            "k̕",
            "k̛",
            "k̦",
            "k͟h",
            "l̂",
            "l̥",
            "l̥̄",
            "l̦",
            "m̀",
            "m̂",
            "m̆",
            "m̐",
            "n̂",
            "n̄",
            "n̆",
            "n̦",
            "p̀",
            "p̄",
            "p̕",
            "p̣",
            "r̆",
            "r̥",
            "r̥̄",
            "s̀",
            "s̄",
            "s̛̄",
            "s̱",
            "t̀",
            "t̄",
            "t̕",
            "t̛",
            "u̇",
            "z̀",
            "z̄",
            "z̆",
            "z̈",
            "z̧",
            "Ç̆",
            "Û̄",
            "ç̆",
            "û̄",
            "ÿ́",
            "Č̕",
            "Č̣",
            "č̕",
            "č̣",
            "Ī́",
            "ī́",
            "Ž̦",
            "Ž̧",
            "ž̦",
            "ž̧",
            "Ḳ̄",
            "ḳ̄",
            "Ṣ̄",
            "ṣ̄",
            "Ṭ̄",
            "ṭ̄",
            "Ạ̈",
            "ạ̈",
            "Ọ̈",
            "ọ̈",
            "Ụ̄",
            "Ụ̈",
            "ụ̄",
            "ụ̈",
        };



        public static readonly string[] NonLettersN1 = {
            " ",
            "'",
            ",",
            "-",
            ".",
            "`",
            "~",
            "¨",
            "´",
            "·",
            "ʹ",
            "ʺ",
            "ʾ",
            "ʿ",
            "ˈ",
            "ˌ",
            "’",
            "‡",
        };

        public static readonly string[] NonLettersN2 = {
            "!",
            "\"",
            "#",
            "$",
            "%",
            "&",
            "(",
            ")",
            "*",
            "+",
            "/",
            "0",
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7",
            "8",
            "9",
            ":",
            ";",
            "<",
            "=",
            ">",
            "?",
            "@",
            "[",
            "\\",
            "]",
            "^",
            "_",
            "{",
            "|",
            "}",
            "¡",
            "¢",
            "£",
            "¥",
            "§",
            "©",
            "ª",
            "«",
            "¬",
            "®",
            "¯",
            "°",
            "±",
            "²",
            "³",
            "µ",
            "¶",
            "¹",
            "º",
            "»",
            "¿",
            "×",
            "÷",
            "€",
        };

        public static readonly string[] NonLettersN3 = {
            "¤",
            "¦",
            "¸",
            "¼",
            "½",
            "¾",
        };

        public static readonly string[] NonLettersN4 = {
            char.ConvertFromUtf32(0x0009), // CHARACTER TABULATION
            char.ConvertFromUtf32(0x000A), // LINE FEED (LF)
            char.ConvertFromUtf32(0x000D), // CARRIAGE RETURN (CR)
            char.ConvertFromUtf32(0x00A0), // NO-BREAK BACKSPACE
        };

        public static readonly string[] GreekLetters = {
            "Ά",
            "Έ",
            "Ή",
            "Ί",
            "Ό",
            "Ύ",
            "Ώ",
            "ΐ",
            "Α",
            "Β",
            "Γ",
            "Δ",
            "Ε",
            "Ζ",
            "Η",
            "Θ",
            "Ι",
            "Κ",
            "Λ",
            "Μ",
            "Ν",
            "Ξ",
            "Ο",
            "Π",
            "Ρ",
            "Σ",
            "Τ",
            "Υ",
            "Φ",
            "Χ",
            "Ψ",
            "Ω",
            "Ϊ",
            "Ϋ",
            "ά",
            "έ",
            "ή",
            "ί",
            "ΰ",
            "α",
            "β",
            "γ",
            "δ",
            "ε",
            "ζ",
            "η",
            "θ",
            "ι",
            "κ",
            "λ",
            "μ",
            "ν",
            "ξ",
            "ο",
            "π",
            "ρ",
            "ς",
            "σ",
            "τ",
            "υ",
            "φ",
            "χ",
            "ψ",
            "ω",
            "ϊ",
            "ϋ",
            "ό",
            "ύ",
            "ώ",
        };

        public static readonly string[] CyrillicLetters = {
            "Ѝ",
            "А",
            "Б",
            "В",
            "Г",
            "Д",
            "Е",
            "Ж",
            "З",
            "И",
            "Й",
            "К",
            "Л",
            "М",
            "Н",
            "О",
            "П",
            "Р",
            "С",
            "Т",
            "У",
            "Ф",
            "Х",
            "Ц",
            "Ч",
            "Ш",
            "Щ",
            "Ъ",
            "Ь",
            "Ю",
            "Я",
            "а",
            "б",
            "в",
            "г",
            "д",
            "е",
            "ж",
            "з",
            "и",
            "й",
            "к",
            "л",
            "м",
            "н",
            "о",
            "п",
            "р",
            "с",
            "т",
            "у",
            "ф",
            "х",
            "ц",
            "ч",
            "ш",
            "щ",
            "ъ",
            "ь",
            "ю",
            "я",
            "ѝ",
        };

        public static readonly string[] NonLettersE1 = {
            "ƒ",
            "ʰ",
            "ʳ",
            "ˆ",
            "˜",
            "ˢ",
            "ᵈ",
            "ᵗ",
            "‘",
            "‚",
            "“",
            "”",
            "„",
            "†",
            "…",
            "‰",
            "′",
            "″",
            "‹",
            "›",
            "⁰",
            "⁴",
            "⁵",
            "⁶",
            "⁷",
            "⁸",
            "⁹",
            "ⁿ",
            "₀",
            "₁",
            "₂",
            "₃",
            "₄",
            "₅",
            "₆",
            "₇",
            "₈",
            "₉",
            "™",
            "∞",
            "≤",
            "≥",
        };

        public static readonly Dictionary<string, string> DeprecatedLatinLetters = new Dictionary<string, string> {
            {"ē̍", "ī́"},
            {"Ŀ", "L·"},
            {"ŀ", "l·"},
            {"ŉ", "'n"},
            {"ō̍", "ṓ"},
            {"ḗ", "ī́"},
        };

        public static IEnumerable<string> GetGlyphEnumerator(string value)
        {
            TextElementEnumerator glyphEnumerator = StringInfo.GetTextElementEnumerator(value);
            while (glyphEnumerator.MoveNext())
            {
                string glyph = glyphEnumerator.GetTextElement();

                // For long glyphs, also include the next text element.
                if (glyph == "K͟" || glyph == "k͟")
                {
                    if (!glyphEnumerator.MoveNext())
                    {
                        yield return glyph;
                        yield break;
                    }

                    glyph = glyph + glyphEnumerator.GetTextElement();
                }

                yield return glyph;

            }
        }

        public static HashSet<string> CreateGlyphSet(string[][] validGlyphArrays)
        {
            HashSet<string> validGlyphs = new HashSet<string>();

            foreach (string[] validGlyphArray in validGlyphArrays)
            {
                validGlyphs.UnionWith(validGlyphArray);
            }

            return validGlyphs;
        }
    }
}